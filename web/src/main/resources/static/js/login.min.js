/**
 *
 * Created by OAKutsenko on 01.02.2018.
 */
function setFormValidation(e){$(e).validate({rules:{phone:{required:!0,rangelength:[14,18],dataLength:!0},code:{required:!0,minlength:6}},errorPlacement:function(e,n){$(n).parent("div").addClass("has-error")},submitHandler:function(e){var n=$("#phone").val().replace(/\D/g,"");switch(findPressedButton(e)){case"code_btn":switchFormState(!0),$("#code").focus().val(""),getSMSCode("+"+n);break;default:onVerifyCodeSubmit($("#code").val().replace(/\D/g,""),n)}}})}function switchFormState(e){$("#country").prop("disabled",e),$("#phone").prop("disabled",e),$("#code").prop("disabled",!e),$("#LoginForm").find('button[type="submit"]').each(function(e){$(this).hasClass("hidden")?$(this).removeClass("hidden"):$(this).addClass("hidden")}),e?($("#btn_forward").addClass("hidden"),$("#btn_back").removeClass("hidden")):($("#btn_back").addClass("hidden"),$("#btn_forward").removeClass("hidden"))}function findPressedButton(e){var n;return $(e).find('button[type="submit"]').each(function(e){$(this).hasClass("hidden")||(n=this.id)}),n}function updateSignInButtonUI(){$("div.card-login").removeClass("hidden"),$("#preloader").hide()}function onSignInSubmit(){}function getSMSCode(e){var n=window.recaptchaVerifier;firebase.auth().signInWithPhoneNumber(e,n).then(function(e){window.confirmationResult=e}).catch(function(e){updateSignInButtonUI(),showNotification("top","left",e.message)})}function onVerifyCodeSubmit(e,n){confirmationResult.confirm(e).then(function(e){firebase.auth().currentUser.getIdToken(!0).then(function(e){login(e,n)}).catch(function(e){showErrorMsg(e)})}).catch(function(e){showErrorMsg(e)})}function showErrorMsg(e){showNotification("top","left",e.message),$("#code").val("")}function showNotification(e,n,d){$.notify({icon:"error_outline",message:d},{type:"danger",timer:4e3,placement:{from:e,align:n}})}function login(e,n){$("div.card-login").addClass("hidden"),$("#preloader").show(),$("input[name='phone']").val(n),$("input[name='credentials']").val(e),$("#auth").submit()}$(document).ready(function(){var e=11;setFormValidation("#LoginForm"),$("#phone").mask("+7 (9dd) ddd-dd-dd",{placeholder:" "}),$("#code").mask("dddddd",{placeholder:" "}),$(".selectpicker").on("changed.bs.select",function(n){var d="+7 (9dd) ddd-dd-dd";switch(e=11,$(".selectpicker").val()){case"2":d="+380 dd ddd-dd-dd",e=12;break;case"3":d="+375 dd ddd-dd-dd",e=12;break;case"4":d="+7 7dd ddd-dd-dd";break;case"5":d="+370 6dd ddddd"}$("#phone").val("").mask(d,{placeholder:" "}).focus(),$("#phone").parent("div").removeClass("has-error"),$("#code").val("")}),$(":input").focusin(function(){}).focusout(function(){$(this).parent("div").removeClass("has-error")}),$.validator.addMethod("dataLength",function(n,d){return n.replace(/\D/g,"").length=e},"Invalid data length."),window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier("captcha",{size:"invisible",callback:function(e){onSignInSubmit()}}),recaptchaVerifier.render().then(function(e){window.recaptchaWidgetId=e,updateSignInButtonUI()})}),$("#btn_forward").click(function(){var e=$("#phone");e.val().length>13&&e.val().length<19?(switchFormState(!0),$("#code").focus().val("")):e.parent("div").addClass("has-error")}),$("#btn_back").click(function(){switchFormState(!1)});
